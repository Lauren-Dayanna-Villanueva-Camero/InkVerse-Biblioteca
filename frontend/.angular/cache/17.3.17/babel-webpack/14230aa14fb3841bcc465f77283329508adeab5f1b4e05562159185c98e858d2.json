{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"@angular/common\";\nfunction BooksComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 17)(2, \"span\", 18);\n    i0.ɵɵtext(3, \"Cargando...\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"p\", 19);\n    i0.ɵɵtext(5, \"Cargando libros...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction BooksComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"strong\");\n    i0.ɵɵtext(2, \"\\u00A1Atenci\\u00F3n!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementStart(4, \"p\", 21)(5, \"small\");\n    i0.ɵɵtext(6, \"Por favor, aseg\\u00FArate de que el backend est\\u00E9 corriendo en \");\n    i0.ɵɵelementStart(7, \"code\");\n    i0.ɵɵtext(8, \"http://localhost:8080\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelement(9, \"button\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.error, \" \");\n  }\n}\nfunction BooksComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 23)(2, \"h5\");\n    i0.ɵɵtext(3, \"No hay libros disponibles en este momento\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 24);\n    i0.ɵɵtext(5, \"El cat\\u00E1logo est\\u00E1 vac\\u00EDo. Por favor, contacta al administrador para agregar libros.\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction BooksComponent_div_8_div_1_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 36);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const libro_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", libro_r3.categoria.nombre, \" \");\n  }\n}\nfunction BooksComponent_div_8_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"div\", 28);\n    i0.ɵɵelement(2, \"img\", 29);\n    i0.ɵɵelementStart(3, \"div\", 30)(4, \"h5\", 31);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 32);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, BooksComponent_div_8_div_1_span_8_Template, 2, 1, \"span\", 33);\n    i0.ɵɵelementStart(9, \"p\", 34)(10, \"small\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function BooksComponent_div_8_div_1_Template_button_click_12_listener() {\n      const libro_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.abrirDetalle(libro_r3));\n    });\n    i0.ɵɵtext(13, \" Ver detalle \");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const libro_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", libro_r3.imagenUrl || \"https://via.placeholder.com/300x220?text=Libro\", i0.ɵɵsanitizeUrl)(\"alt\", libro_r3.titulo);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(libro_r3.titulo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", libro_r3.autor, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", libro_r3.categoria);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Disponibles: \", libro_r3.cantidadDisponible, \"\");\n  }\n}\nfunction BooksComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtemplate(1, BooksComponent_div_8_div_1_Template, 14, 6, \"div\", 26);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.libros);\n  }\n}\nfunction BooksComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37)(1, \"div\", 38)(2, \"div\", 39);\n    i0.ɵɵelement(3, \"img\", 40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 41)(5, \"p\")(6, \"strong\");\n    i0.ɵɵtext(7, \"Autor:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"p\")(12, \"strong\");\n    i0.ɵɵtext(13, \"Disponibles:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r0.selectedBook.imagenUrl || \"https://via.placeholder.com/300x220?text=Libro\", i0.ɵɵsanitizeUrl)(\"alt\", ctx_r0.selectedBook.titulo);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.selectedBook.autor, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.selectedBook.descripcion);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.selectedBook.cantidadDisponible, \"\");\n  }\n}\nexport let BooksComponent = /*#__PURE__*/(() => {\n  class BooksComponent {\n    apiService;\n    authService;\n    libros = [];\n    loading = false;\n    error = null;\n    selectedBook = null;\n    constructor(apiService, authService) {\n      this.apiService = apiService;\n      this.authService = authService;\n    }\n    ngOnInit() {\n      console.log('BooksComponent inicializado');\n      this.cargarLibros();\n    }\n    cargarLibros() {\n      this.loading = true;\n      this.error = null;\n      this.apiService.listarLibros().subscribe({\n        next: libros => {\n          this.libros = libros;\n          this.loading = false;\n        },\n        error: () => {\n          this.error = 'Error al cargar los libros.';\n          this.loading = false;\n        }\n      });\n    }\n    abrirDetalle(libro) {\n      this.selectedBook = libro;\n      const modalEl = document.getElementById('bookModal');\n      if (modalEl) {\n        const modal = new bootstrap.Modal(modalEl);\n        modal.show();\n      }\n    }\n    prestarSeleccionado() {\n      if (!this.selectedBook) {\n        return;\n      }\n      if (!this.authService.isLoggedIn()) {\n        const loginModal = document.getElementById('loginModal');\n        if (loginModal) {\n          const modal = new bootstrap.Modal(loginModal);\n          modal.show();\n        }\n        return;\n      }\n      this.apiService.prestarLibro(this.selectedBook.id).subscribe({\n        next: () => {\n          this.cargarLibros();\n          const modalEl = document.getElementById('bookModal');\n          if (modalEl) {\n            const modal = bootstrap.Modal.getInstance(modalEl);\n            if (modal) {\n              modal.hide();\n            }\n          }\n          alert('Libro prestado correctamente.');\n        },\n        error: err => {\n          const msg = err?.error?.message || 'Error al prestar el libro.';\n          alert(msg);\n        }\n      });\n    }\n    static ɵfac = function BooksComponent_Factory(t) {\n      return new (t || BooksComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.AuthService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: BooksComponent,\n      selectors: [[\"app-books\"]],\n      decls: 22,\n      vars: 6,\n      consts: [[1, \"text-center\", \"mb-4\"], [1, \"page-title\"], [1, \"text-muted\"], [\"class\", \"text-center my-5\", 4, \"ngIf\"], [\"class\", \"alert alert-warning alert-dismissible fade show\", \"role\", \"alert\", 4, \"ngIf\"], [\"class\", \"row g-4\", 4, \"ngIf\"], [\"id\", \"bookModal\", \"tabindex\", \"-1\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\", \"modal-lg\", \"modal-dialog-centered\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn-close\"], [\"class\", \"modal-body\", 4, \"ngIf\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-outline-secondary\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"text-center\", \"my-5\"], [\"role\", \"status\", 1, \"spinner-border\", \"text-warning\"], [1, \"visually-hidden\"], [1, \"mt-3\", \"text-muted\"], [\"role\", \"alert\", 1, \"alert\", \"alert-warning\", \"alert-dismissible\", \"fade\", \"show\"], [1, \"mb-0\", \"mt-2\"], [\"type\", \"button\", \"data-bs-dismiss\", \"alert\", 1, \"btn-close\"], [1, \"alert\", \"alert-info\"], [1, \"mb-0\"], [1, \"row\", \"g-4\"], [\"class\", \"col-sm-6 col-md-4 col-lg-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-sm-6\", \"col-md-4\", \"col-lg-3\"], [1, \"card\", \"card-book\", \"h-100\"], [1, \"card-img-top\", 3, \"src\", \"alt\"], [1, \"card-body\", \"d-flex\", \"flex-column\"], [1, \"card-title\", \"mb-1\"], [1, \"card-text\", \"text-muted\", \"mb-1\"], [\"class\", \"badge badge-category mb-2\", 4, \"ngIf\"], [1, \"mb-2\"], [1, \"btn\", \"btn-primary\", \"mt-auto\", 3, \"click\"], [1, \"badge\", \"badge-category\", \"mb-2\"], [1, \"modal-body\"], [1, \"row\"], [1, \"col-md-4\", \"mb-3\", \"mb-md-0\"], [1, \"img-fluid\", \"rounded\", 3, \"src\", \"alt\"], [1, \"col-md-8\"]],\n      template: function BooksComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1);\n          i0.ɵɵtext(2, \"Libros disponibles\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"p\", 2);\n          i0.ɵɵtext(4, \"Explora nuestro cat\\u00E1logo y presta tus libros favoritos.\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(5, BooksComponent_div_5_Template, 6, 0, \"div\", 3)(6, BooksComponent_div_6_Template, 10, 1, \"div\", 4)(7, BooksComponent_div_7_Template, 6, 0, \"div\", 3)(8, BooksComponent_div_8_Template, 2, 1, \"div\", 5);\n          i0.ɵɵelementStart(9, \"div\", 6)(10, \"div\", 7)(11, \"div\", 8)(12, \"div\", 9)(13, \"h5\", 10);\n          i0.ɵɵtext(14);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(15, \"button\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(16, BooksComponent_div_16_Template, 15, 5, \"div\", 12);\n          i0.ɵɵelementStart(17, \"div\", 13)(18, \"button\", 14);\n          i0.ɵɵtext(19, \" Cerrar \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"button\", 15);\n          i0.ɵɵlistener(\"click\", function BooksComponent_Template_button_click_20_listener() {\n            return ctx.prestarSeleccionado();\n          });\n          i0.ɵɵtext(21, \" PRESTAR \");\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error && ctx.libros.length === 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error && ctx.libros.length > 0);\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate1(\" \", ctx.selectedBook == null ? null : ctx.selectedBook.titulo, \" \");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedBook);\n        }\n      },\n      dependencies: [i3.NgForOf, i3.NgIf],\n      styles: [\".page-title[_ngcontent-%COMP%]{letter-spacing:.03em}\"]\n    });\n  }\n  return BooksComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}