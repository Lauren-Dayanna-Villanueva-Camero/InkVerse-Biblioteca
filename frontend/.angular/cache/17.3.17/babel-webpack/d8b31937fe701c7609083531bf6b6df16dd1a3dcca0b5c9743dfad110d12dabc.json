{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/auth.service\";\nimport * as i2 from \"../../services/admin.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nconst _c0 = [\"categoriasTable\"];\nfunction AdminCategoriasComponent_tr_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"tr\")(1, \"td\");\n    i0.…µ…µtext(2);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"td\")(4, \"strong\");\n    i0.…µ…µtext(5);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(6, \"td\")(7, \"button\", 31);\n    i0.…µ…µlistener(\"click\", function AdminCategoriasComponent_tr_28_Template_button_click_7_listener() {\n      const categoria_r3 = i0.…µ…µrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r3.abrirEditarCategoria(categoria_r3));\n    });\n    i0.…µ…µtext(8, \" \\u270F\\uFE0F \");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(9, \"button\", 32);\n    i0.…µ…µlistener(\"click\", function AdminCategoriasComponent_tr_28_Template_button_click_9_listener() {\n      const categoria_r3 = i0.…µ…µrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r3.eliminarCategoria(categoria_r3));\n    });\n    i0.…µ…µtext(10, \" \\uD83D\\uDDD1\\uFE0F \");\n    i0.…µ…µelementEnd()()();\n  }\n  if (rf & 2) {\n    const categoria_r3 = ctx.$implicit;\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate(categoria_r3.id);\n    i0.…µ…µadvance(3);\n    i0.…µ…µtextInterpolate(categoria_r3.nombre);\n  }\n}\nexport let AdminCategoriasComponent = /*#__PURE__*/(() => {\n  class AdminCategoriasComponent {\n    authService;\n    adminService;\n    router;\n    fb;\n    categoriasTable;\n    categorias = [];\n    mostrarFormularioCategoria = false;\n    modoEdicionCategoria = false;\n    categoriaSeleccionada = null;\n    categoriaForm;\n    constructor(authService, adminService, router, fb) {\n      this.authService = authService;\n      this.adminService = adminService;\n      this.router = router;\n      this.fb = fb;\n      this.categoriaForm = this.fb.group({\n        nombre: ['', Validators.required]\n      });\n    }\n    ngOnInit() {\n      if (!this.authService.isAdmin()) {\n        this.router.navigate(['/']);\n        return;\n      }\n      this.cargarCategorias();\n    }\n    ngAfterViewInit() {\n      // DataTable se inicializar√° despu√©s de cargar los datos\n    }\n    cargarCategorias() {\n      // Destruir DataTable si existe antes de cargar nuevos datos\n      if (this.categoriasTable && this.categoriasTable.nativeElement) {\n        if ($.fn.DataTable.isDataTable(this.categoriasTable.nativeElement)) {\n          $(this.categoriasTable.nativeElement).DataTable().destroy();\n        }\n      }\n      this.adminService.listarCategorias().subscribe({\n        next: categorias => {\n          console.log('üìö Categor√≠as cargadas:', categorias.length);\n          this.categorias = categorias;\n          // Reinicializar DataTable despu√©s de actualizar los datos\n          setTimeout(() => this.inicializarDataTableCategorias(), 100);\n        },\n        error: err => {\n          console.error('‚ùå Error al cargar categor√≠as:', err);\n        }\n      });\n    }\n    inicializarDataTableCategorias() {\n      if (this.categoriasTable && this.categoriasTable.nativeElement) {\n        if ($.fn.DataTable.isDataTable(this.categoriasTable.nativeElement)) {\n          $(this.categoriasTable.nativeElement).DataTable().destroy();\n        }\n        $(this.categoriasTable.nativeElement).DataTable({\n          language: {\n            url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json'\n          },\n          pageLength: 10,\n          order: [[0, 'asc']],\n          columnDefs: [{\n            orderable: false,\n            targets: [2]\n          } // Botones de acci√≥n no ordenables\n          ]\n        });\n      }\n    }\n    abrirCrearCategoria() {\n      this.modoEdicionCategoria = false;\n      this.categoriaSeleccionada = null;\n      this.categoriaForm.reset();\n      this.mostrarFormularioCategoria = true;\n      const modal = new bootstrap.Modal(document.getElementById('categoriaModal'));\n      modal.show();\n    }\n    abrirEditarCategoria(categoria) {\n      this.modoEdicionCategoria = true;\n      this.categoriaSeleccionada = categoria;\n      this.categoriaForm.patchValue({\n        nombre: categoria.nombre\n      });\n      this.mostrarFormularioCategoria = true;\n      const modal = new bootstrap.Modal(document.getElementById('categoriaModal'));\n      modal.show();\n    }\n    guardarCategoria() {\n      if (this.categoriaForm.invalid) {\n        this.categoriaForm.markAllAsTouched();\n        return;\n      }\n      const categoria = {\n        id: this.categoriaSeleccionada?.id || 0,\n        nombre: this.categoriaForm.value.nombre\n      };\n      const operacion = this.modoEdicionCategoria ? this.adminService.actualizarCategoria(categoria.id, categoria) : this.adminService.crearCategoria(categoria);\n      operacion.subscribe({\n        next: categoriaGuardada => {\n          console.log('‚úÖ Categor√≠a guardada:', categoriaGuardada);\n          this.cerrarModalCategoria();\n          // Recargar categor√≠as y reinicializar DataTable\n          this.cargarCategorias();\n          alert(this.modoEdicionCategoria ? '‚úÖ Categor√≠a actualizada exitosamente' : '‚úÖ Categor√≠a creada exitosamente');\n        },\n        error: err => {\n          console.error('‚ùå Error al guardar categor√≠a:', err);\n          alert(err?.error?.message || err?.error?.error || 'Error al guardar la categor√≠a');\n        }\n      });\n    }\n    eliminarCategoria(categoria) {\n      if (!confirm(`¬øEst√°s seguro de eliminar la categor√≠a \"${categoria.nombre}\"?`)) {\n        return;\n      }\n      this.adminService.eliminarCategoria(categoria.id).subscribe({\n        next: () => {\n          console.log('‚úÖ Categor√≠a eliminada');\n          this.cargarCategorias();\n          alert('‚úÖ Categor√≠a eliminada exitosamente');\n        },\n        error: err => {\n          console.error('‚ùå Error al eliminar categor√≠a:', err);\n          alert(err?.error?.message || err?.error?.error || 'Error al eliminar la categor√≠a');\n        }\n      });\n    }\n    cerrarModalCategoria() {\n      const modal = bootstrap.Modal.getInstance(document.getElementById('categoriaModal'));\n      if (modal) {\n        modal.hide();\n      }\n      this.mostrarFormularioCategoria = false;\n      this.categoriaSeleccionada = null;\n      this.categoriaForm.reset();\n    }\n    static …µfac = function AdminCategoriasComponent_Factory(t) {\n      return new (t || AdminCategoriasComponent)(i0.…µ…µdirectiveInject(i1.AuthService), i0.…µ…µdirectiveInject(i2.AdminService), i0.…µ…µdirectiveInject(i3.Router), i0.…µ…µdirectiveInject(i4.FormBuilder));\n    };\n    static …µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n      type: AdminCategoriasComponent,\n      selectors: [[\"app-admin-categorias\"]],\n      viewQuery: function AdminCategoriasComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.…µ…µviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.…µ…µqueryRefresh(_t = i0.…µ…µloadQuery()) && (ctx.categoriasTable = _t.first);\n        }\n      },\n      decls: 51,\n      vars: 7,\n      consts: [[\"categoriasTable\", \"\"], [1, \"admin-container\"], [1, \"container-fluid\", \"py-4\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"mb-4\"], [1, \"page-title\", \"mb-2\"], [1, \"text-muted\"], [1, \"btn\", \"btn-info\", 3, \"click\"], [1, \"card\", \"shadow-sm\"], [1, \"card-header\", \"bg-info\", \"text-white\"], [1, \"mb-0\"], [1, \"card-body\"], [1, \"table-responsive\"], [\"id\", \"categoriasTable\", 1, \"table\", \"table-striped\", \"table-hover\"], [1, \"table-dark\"], [4, \"ngFor\", \"ngForOf\"], [\"id\", \"categoriaModal\", \"tabindex\", \"-1\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\", \"modal-dialog-centered\"], [1, \"modal-content\"], [1, \"modal-header\", \"bg-info\", \"text-white\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn-close\", \"btn-close-white\", 3, \"click\"], [1, \"modal-body\"], [3, \"ngSubmit\", \"formGroup\"], [1, \"mb-3\"], [1, \"form-label\"], [1, \"text-danger\"], [\"type\", \"text\", \"formControlName\", \"nombre\", \"placeholder\", \"Ej: Ficci\\u00F3n, Ciencia, Historia...\", 1, \"form-control\"], [1, \"invalid-feedback\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-info\", 3, \"disabled\"], [\"title\", \"Editar\", 1, \"btn\", \"btn-sm\", \"btn-warning\", \"me-1\", 3, \"click\"], [\"title\", \"Eliminar\", 1, \"btn\", \"btn-sm\", \"btn-danger\", 3, \"click\"]],\n      template: function AdminCategoriasComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.…µ…µgetCurrentView();\n          i0.…µ…µelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"div\")(4, \"h1\", 4);\n          i0.…µ…µtext(5, \" \\uD83C\\uDFF7\\uFE0F Gesti\\u00F3n de Categor\\u00EDas \");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelementStart(6, \"p\", 5);\n          i0.…µ…µtext(7, \"Administra las categor\\u00EDas de libros\");\n          i0.…µ…µelementEnd()();\n          i0.…µ…µelementStart(8, \"div\")(9, \"button\", 6);\n          i0.…µ…µlistener(\"click\", function AdminCategoriasComponent_Template_button_click_9_listener() {\n            i0.…µ…µrestoreView(_r1);\n            return i0.…µ…µresetView(ctx.abrirCrearCategoria());\n          });\n          i0.…µ…µtext(10, \" \\u2795 Nueva Categor\\u00EDa \");\n          i0.…µ…µelementEnd()()();\n          i0.…µ…µelementStart(11, \"div\", 7)(12, \"div\", 8)(13, \"h5\", 9);\n          i0.…µ…µtext(14, \" \\uD83C\\uDFF7\\uFE0F Lista de Categor\\u00EDas \");\n          i0.…µ…µelementEnd()();\n          i0.…µ…µelementStart(15, \"div\", 10)(16, \"div\", 11)(17, \"table\", 12, 0)(19, \"thead\", 13)(20, \"tr\")(21, \"th\");\n          i0.…µ…µtext(22, \"ID\");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelementStart(23, \"th\");\n          i0.…µ…µtext(24, \"Nombre\");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelementStart(25, \"th\");\n          i0.…µ…µtext(26, \"Acciones\");\n          i0.…µ…µelementEnd()()();\n          i0.…µ…µelementStart(27, \"tbody\");\n          i0.…µ…µtemplate(28, AdminCategoriasComponent_tr_28_Template, 11, 2, \"tr\", 14);\n          i0.…µ…µelementEnd()()()()()()();\n          i0.…µ…µelementStart(29, \"div\", 15)(30, \"div\", 16)(31, \"div\", 17)(32, \"div\", 18)(33, \"h5\", 19);\n          i0.…µ…µtext(34);\n          i0.…µ…µelementEnd();\n          i0.…µ…µelementStart(35, \"button\", 20);\n          i0.…µ…µlistener(\"click\", function AdminCategoriasComponent_Template_button_click_35_listener() {\n            i0.…µ…µrestoreView(_r1);\n            return i0.…µ…µresetView(ctx.cerrarModalCategoria());\n          });\n          i0.…µ…µelementEnd()();\n          i0.…µ…µelementStart(36, \"div\", 21)(37, \"form\", 22);\n          i0.…µ…µlistener(\"ngSubmit\", function AdminCategoriasComponent_Template_form_ngSubmit_37_listener() {\n            i0.…µ…µrestoreView(_r1);\n            return i0.…µ…µresetView(ctx.guardarCategoria());\n          });\n          i0.…µ…µelementStart(38, \"div\", 23)(39, \"label\", 24);\n          i0.…µ…µtext(40, \"Nombre de la Categor\\u00EDa \");\n          i0.…µ…µelementStart(41, \"span\", 25);\n          i0.…µ…µtext(42, \"*\");\n          i0.…µ…µelementEnd()();\n          i0.…µ…µelement(43, \"input\", 26);\n          i0.…µ…µelementStart(44, \"div\", 27);\n          i0.…µ…µtext(45, \"El nombre de la categor\\u00EDa es requerido\");\n          i0.…µ…µelementEnd()();\n          i0.…µ…µelementStart(46, \"div\", 28)(47, \"button\", 29);\n          i0.…µ…µlistener(\"click\", function AdminCategoriasComponent_Template_button_click_47_listener() {\n            i0.…µ…µrestoreView(_r1);\n            return i0.…µ…µresetView(ctx.cerrarModalCategoria());\n          });\n          i0.…µ…µtext(48, \" Cancelar \");\n          i0.…µ…µelementEnd();\n          i0.…µ…µelementStart(49, \"button\", 30);\n          i0.…µ…µtext(50);\n          i0.…µ…µelementEnd()()()()()()();\n        }\n        if (rf & 2) {\n          let tmp_4_0;\n          i0.…µ…µadvance(28);\n          i0.…µ…µproperty(\"ngForOf\", ctx.categorias);\n          i0.…µ…µadvance(6);\n          i0.…µ…µtextInterpolate1(\" \", ctx.modoEdicionCategoria ? \"Editar Categor\\u00EDa\" : \"Nueva Categor\\u00EDa\", \" \");\n          i0.…µ…µadvance(3);\n          i0.…µ…µproperty(\"formGroup\", ctx.categoriaForm);\n          i0.…µ…µadvance(6);\n          i0.…µ…µclassProp(\"is-invalid\", ((tmp_4_0 = ctx.categoriaForm.get(\"nombre\")) == null ? null : tmp_4_0.invalid) && ((tmp_4_0 = ctx.categoriaForm.get(\"nombre\")) == null ? null : tmp_4_0.touched));\n          i0.…µ…µadvance(6);\n          i0.…µ…µproperty(\"disabled\", ctx.categoriaForm.invalid);\n          i0.…µ…µadvance();\n          i0.…µ…µtextInterpolate1(\" \", ctx.modoEdicionCategoria ? \"Actualizar\" : \"Crear\", \" Categor\\u00EDa \");\n        }\n      },\n      dependencies: [i5.NgForOf, i4.…µNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName],\n      styles: [\".admin-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#eff6ff,#dbeafe,#bfdbfe);padding:20px 0}.page-title[_ngcontent-%COMP%]{color:var(--color-dark);font-weight:700;font-size:2rem;text-shadow:0 2px 4px rgba(30,58,138,.1)}.card[_ngcontent-%COMP%]{border-radius:1rem;border:none;box-shadow:0 4px 6px #2563eb26;transition:transform .2s,box-shadow .2s;background:#fff;border:1px solid rgba(37,99,235,.1)}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 16px #2563eb40;border-color:var(--color-primary)}.card-header[_ngcontent-%COMP%]{border-radius:1rem 1rem 0 0!important;font-weight:600;background:linear-gradient(90deg,#0ea5e9,#0284c7)!important}.table[_ngcontent-%COMP%]{margin-bottom:0}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #0ea5e9;font-weight:600;text-transform:uppercase;font-size:.85rem;letter-spacing:.5px;background:linear-gradient(180deg,#0ea5e9,#0284c7);color:#fff}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--color-light-2)}.btn[_ngcontent-%COMP%]{border-radius:.5rem;font-weight:500;transition:all .2s}.btn-info[_ngcontent-%COMP%]{background:linear-gradient(90deg,#0ea5e9,#0284c7);border:none;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0ea5e966;background:linear-gradient(90deg,#0284c7,#0369a1);color:#fff}.btn-warning[_ngcontent-%COMP%]{background-color:#f59e0b;border-color:#f59e0b}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#d97706;border-color:#d97706;box-shadow:0 4px 8px #f59e0b4d}.btn-danger[_ngcontent-%COMP%]{background-color:#ef4444;border-color:#ef4444}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc2626;border-color:#dc2626;box-shadow:0 4px 8px #ef44444d}.modal-content[_ngcontent-%COMP%]{border-radius:1rem;border:none;box-shadow:0 10px 30px #0ea5e933}.modal-header[_ngcontent-%COMP%]{border-radius:1rem 1rem 0 0;background:linear-gradient(90deg,#0ea5e9,#0284c7)!important}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#0ea5e9;box-shadow:0 0 0 .2rem #0ea5e940}.dataTables_wrapper[_ngcontent-%COMP%]{padding-top:1rem}.dataTables_filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:.5rem;border:1px solid var(--color-accent);padding:.5rem;transition:all .2s}.dataTables_filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#0ea5e9;box-shadow:0 0 0 .2rem #0ea5e940;outline:none}.dataTables_length[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:.5rem;border:1px solid var(--color-accent);padding:.5rem;transition:all .2s}.dataTables_length[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#0ea5e9;box-shadow:0 0 0 .2rem #0ea5e940;outline:none}@media (max-width: 768px){.page-title[_ngcontent-%COMP%]{font-size:1.5rem}.table-responsive[_ngcontent-%COMP%]{font-size:.9rem}}\"]\n    });\n  }\n  return AdminCategoriasComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}